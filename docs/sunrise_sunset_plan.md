# ☀️ 日出日落時間功能實作計劃

## 功能概述

在天氣查詢結果中顯示當天的日出、日落時間，並計算白天長度，讓使用者能更好地規劃戶外活動。

## 目標使用者

- 📸 攝影師（黃金時段拍攝）
- 🏃 晨跑者、運動愛好者
- 🌅 觀賞日出/日落的遊客
- 🌾 農民、戶外工作者

## 技術方案

### 方案比較

| 方案 | 優點 | 缺點 | 推薦度 |
|------|------|------|--------|
| **SunCalc.js 函式庫** | ✅ 精確、免費、離線計算 | ⚠️ 需引入額外函式庫 | ⭐⭐⭐⭐⭐ |
| **天文計算公式** | ✅ 完全自主、無依賴 | ❌ 複雜、容易出錯 | ⭐⭐ |
| **Sunrise-Sunset API** | ✅ 簡單、可靠 | ❌ 需網路請求、延遲 | ⭐⭐⭐ |

**選擇**: SunCalc.js（推薦）

### SunCalc.js 簡介

- **CDN**: `https://cdn.jsdelivr.net/npm/suncalc@1.9.0/suncalc.min.js`
- **大小**: ~5KB (Minified)
- **授權**: BSD-2-Clause
- **功能**: 計算日出、日落、晨昏、月相等

## 實作計劃

### 1. 前端整合 SunCalc.js

**檔案**: `web/index.html`

在 `<head>` 中加入 CDN：
```html
<script src="https://cdn.jsdelivr.net/npm/suncalc@1.9.0/suncalc.min.js"></script>
```

### 2. 前端計算邏輯

**檔案**: `web/script.js`

新增函數：
```javascript
function calculateSunTimes(lat, lon, date) {
    const times = SunCalc.getTimes(date, lat, lon);
    return {
        sunrise: times.sunrise,
        sunset: times.sunset,
        dayLength: (times.sunset - times.sunrise) / (1000 * 60 * 60) // 小時
    };
}
```

### 3. UI 設計

**位置**: 生活建議卡片下方新增「天文資訊」區塊

```
┌─────────────────────────────┐
│  🌅 天文資訊                 │
├─────────────────────────────┤
│  日出  🌄  06:23            │
│  日落  🌇  17:15            │
│  白天長度  ⏱️  10 小時 52 分 │
└─────────────────────────────┘
```

### 4. CSS 樣式

**檔案**: `web/style.css`

新增樣式類別：
- `.sun-info-card` - 天文資訊卡片
- `.sun-time-item` - 日出/日落項目
- `.sun-icon` - 圖標樣式

### 5. 城市座標對應

**現有資源**: `script.js` 中已有 `CITY_COORDS` 物件

```javascript
const CITY_COORDS = {
    "臺北市": { lat: 25.0375, lon: 121.5625 },
    "高雄市": { lat: 22.6273, lon: 120.3014 },
    // ... 其他縣市
};
```

✅ 無需額外處理，直接使用！

## 顯示規劃

### 資訊卡片內容

1. **日出時間** 🌄
   - 格式: `HH:MM`
   - 圖標: 🌄 或 ☀️

2. **日落時間** 🌇
   - 格式: `HH:MM`
   - 圖標: 🌇 或 🌆

3. **白天長度** ⏱️
   - 格式: `X 小時 Y 分鐘`
   - 顏色編碼:
     - 夏季（長）: 🟢 綠色
     - 冬季（短）: 🔵 藍色

### 進階功能（可選）

- [ ] 黃金時段提示（日出前後 1 小時）
- [ ] 藍調時刻提示（晨昏魚肚白）
- [ ] 月相資訊
- [ ] 天頂時間（太陽最高點）

## 檔案修改清單

| 檔案 | 修改內容 | 優先級 |
|------|---------|--------|
| `web/index.html` | 引入 SunCalc.js CDN | 🔴 必須 |
| `web/script.js` | 新增計算函數、UI 渲染 | 🔴 必須 |
| `web/style.css` | 新增天文資訊卡片樣式 | 🔴 必須 |
| `docs/future_features.md` | 標記功能為已完成 | 🟡 文檔 |

## 驗證測試

### 測試案例

1. **臺北市** (北部)
   - 預期: 日出 ~06:20, 日落 ~17:15

2. **高雄市** (南部)
   - 預期: 日出 ~06:15, 日落 ~17:25

3. **花蓮縣** (東部)
   - 預期: 日出較早

### 邊界測試

- 跨日測試（午夜 00:00）
- 季節變化（夏至/冬至）
- 不同縣市經緯度

## 時程預估

- **規劃**: 10 分鐘 ✅
- **開發**: 30 分鐘
- **測試**: 10 分鐘
- **文檔**: 10 分鐘

**總計**: 約 1 小時

---

## 實作順序

1. ✅ 建立規劃文件
2. ⬜ 引入 SunCalc.js
3. ⬜ 實作計算邏輯
4. ⬜ 建立 UI 元件
5. ⬜ 加入 CSS 樣式
6. ⬜ 整合到查詢流程
7. ⬜ 測試驗證
8. ⬜ 更新文檔

---

準備開始實作！🚀
