# 📋 TW Weather 專案功能總表 (Feature List)

這份文件清楚列出了本專案所有的功能細節，分為「前端使用者介面」與「後端核心邏輯」兩大部分。

## 1. 🖥️ 前端使用者功能 (Frontend Features)

這部分是使用者在網頁上可以直接看到或操作的功能。

| 功能名稱 | 功能描述 | 操作方式 |
| :--- | :--- | :--- |
| **📍 自動定位查詢** | 利用瀏覽器 GPS API 偵測使用者所在城市，並自動查詢當地天氣。 | 點擊搜尋欄旁的「定位圖示」。 |
| **🔍 關鍵字搜尋** | 支援輸入城市名稱 (如: 台中、Taipei) 快速查找天氣。 | 在搜尋欄輸入文字並按下「搜尋」或 Enter 鍵。 |
| **🌥️ 即時天氣顯示** | 顯示所選城市的目前溫度、體感溫度、濕度、氣壓、風速。 | 查詢成功後自動顯示於主卡片。 |
| **📅 一週天氣預報** | 提供未來 7 天的高溫、低溫預測與降雨機率。 | 顯示於即時天氣卡片下方。 |
| **😷 AQI 空氣品質** | 顯示空氣品質指標 (AQI) 與 PM2.5 數值，提供健康狀態燈號 (綠/黃/紅)。 | 自動隨城市更新，位於頁面中段。 |
| **👗 智慧穿搭建議** | 根據目前體感溫度與降雨機率，建議合適的衣著 (如: 短袖、帶傘)。 | 顯示於「穿搭建議」卡片。 |
| **🗺️ 即時雷達地圖** | 整合 Leaflet 地圖，疊加氣象署最新的雷達回波圖，觀察雨雲動向。 | 顯示於頁面右下方的地圖區塊。 |
| **🎤 語音查詢助理** | 支援語音輸入城市名稱進行查詢 (Speech-to-Text)。 | 點擊搜尋欄內的「麥克風圖示」，說出地名。 |
| **🔊 語音天氣播報** | 將當前的天氣資訊朗讀出來 (Text-to-Speech)。 | 點擊「聆聽播報」按鈕。 |
| **📊 歷史數據統計** | 顯示過去查詢紀錄的平均溫、最高溫，並繪製溫度趨勢長條圖。 | 位於頁面最下方的「歷史統計」區塊。 |
| **🔽 統計城市篩選** | 可篩選特定城市的歷史統計數據，或查看全台灣平均。 | 使用統計區塊的下拉式選單。 |
| **📥 資料匯出 (Excel)** | 將目前資料庫累積的所有天氣紀錄匯出成 Excel 報表。 | 點擊統計區塊右上角的「匯出按鈕」。 |

---

## 2. ⚙️ 後端核心功能 (Backend Functions)

這部分是 Python 在伺服器端執行的功能，使用者看不見，但對系統運作至關重要。

| 功能名稱 | 技術內容 | 觸發/運作時機 |
| :--- | :--- | :--- |
| **RESTful API 服務** | 提供標準化的 JSON 資料接口 (`/api/weather`, `/api/stats`) 供前端呼叫。 | 前端發起請求時。 |
| **第三方 API 串接** | 使用 `Requests` 模組向 **CWA (氣象署)** 與 **EPA (環境部)** 抓取即時資料。 | 收到天氣查詢請求時。 |
| **資料自動清洗** | 解析複雜的 Open Data JSON 結構，過濾雜訊，轉換為統一字典格式。 | 取得外部資料後立即執行。 |
| **自動資料記錄** | 將每次查詢結果 (城市、溫度、時間) 自動 `INSERT` 寫入 SQLite 資料庫。 | 查詢成功回傳前。 |
| **Pandas 數據分析** | 從資料庫讀取歷史資料，利用 DataFrame 計算平均值 (`mean`) 與極值 (`max`)。 | 呼叫 `/api/stats` 時。 |
| **缺失值與例外處理** | 填補資料庫中的空值 (NaN)，並處理網路斷線或 API 錯誤，防止當機。 | 全程運作。 |
| **背景災害監控** | 啟動獨立執行緒 (`Threading`)，每 5 分鐘自動檢查氣象局警報 API。 | 系統啟動後持續在背景執行。 |
| **檔案串流匯出** | 結合 Pandas `to_excel` 與 Flask `send_file`，實作二進位檔案下載。 | 呼叫 `/api/export` 時。 |
